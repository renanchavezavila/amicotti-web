<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Amicotti — Salud y bienestar para tus mascotas</title>
  <meta name="description" content="Entrega rápida en Quito y Valles. Compra por WhatsApp. Productos oficiales Royal Canin y Purina."/>
  <link rel="icon" href="assets/logo.png"/>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .img-box{height:12rem}
    .img-box img{max-height:11rem;object-fit:contain}
    .chip{font-size:.7rem}
    .carousel-track{ display:flex; will-change: transform; }
    .carousel-slide{ min-width:100%; }
    .dot{ width:8px; height:8px; border-radius:9999px; }
    .promo-img-wrap{ display:grid; place-items:center; padding:1rem; background:#fff; }
    .promo-img{ width:auto; height:auto; max-height:520px; object-fit:contain; }
    @media (max-width:1024px){ .promo-img{ max-height:420px; } }
    @media (max-width:640px){ .promo-img{ max-height:320px; } }
  </style>
</head>
<body class="bg-[#F5F7FA] text-gray-900 selection:bg-rose-100 selection:text-rose-700">

<!-- Top strip -->
<div class="text-xs bg-slate-900 text-slate-200">
  <div class="max-w-6xl mx-auto flex items-center justify-between px-4 py-1">
    <span>Entrega en Quito y Valles</span>
    <span>Pagos: <strong class="text-white">transferencia bancaria</strong></span>
    <a id="waTop" class="underline hover:no-underline" target="_blank" rel="noopener">Atención WhatsApp</a>
  </div>
</div>

<!-- Header con filtros -->
<header class="sticky top-0 z-40 border-b bg-[#F2F0FF]/95 backdrop-blur">
  <div class="max-w-6xl mx-auto px-4 py-3 grid grid-cols-1 gap-3 md:grid-cols-[auto,1fr,auto] items-center">
    <!-- Logo -->
    <a href="index.html" class="flex items-center gap-2">
      <img src="assets/logo.png" class="w-9 h-9 rounded" alt="Amicotti"/>
      <span class="font-semibold tracking-tight">Amicotti</span>
    </a>

    <!-- Filtros (desktop) -->
    <div class="hidden md:grid grid-cols-4 gap-2 items-center">
      <select id="f-categoria" class="rounded-xl border border-neutral-300 bg-white px-3 py-2 text-sm">
        <option value="">Categoría</option>
        <option>Seco</option>
        <option>Húmedo</option>
        <option>Snacks</option>
        <option>Veterinary</option>
      </select>
      <select id="f-marca" class="rounded-xl border border-neutral-300 bg-white px-3 py-2 text-sm">
        <option value="">Marca</option>
        <option>Royal Canin</option>
        <option>Purina</option>
        <option>Cat Chow</option>
        <option>Dog Chow</option>
        <option>Excellent</option>
        <option>Felix</option>
        <option>Fancy Feast</option>
      </select>
      <select id="f-especie" class="rounded-xl border border-neutral-300 bg-white px-3 py-2 text-sm">
        <option value="">Especie</option>
        <option>Gato</option>
        <option>Perro</option>
      </select>
      <div class="relative">
        <input id="f-search" type="search" placeholder="Buscar producto…" class="w-full rounded-xl border border-neutral-300 bg-white px-3 py-2 text-sm pr-10">
        <button id="f-search-btn" class="absolute right-1 top-1/2 -translate-y-1/2 rounded-lg border border-neutral-300 px-2 py-1 text-xs">Buscar</button>
      </div>
    </div>

    <!-- Acciones -->
    <div class="flex items-center gap-2 justify-end">
      <a href="catalogo.html" class="hidden lg:inline-flex px-4 py-2 rounded-xl bg-rose-600 text-white hover:bg-rose-700">Catálogo</a>
      <a href="#contacto" class="hidden lg:inline-flex px-4 py-2 rounded-xl border">Contacto</a>
      <a href="#" id="waHeader" class="hidden sm:inline-flex px-3 py-2 rounded-xl border">WhatsApp</a>
      <button id="btn-cart-open" class="relative rounded-xl border px-3 py-2 text-sm">
        <span>Carrito</span>
        <span id="cart-count" class="absolute -right-2 -top-2 inline-flex h-5 min-w-[1.25rem] items-center justify-center rounded-full bg-rose-600 text-white text-[11px] px-1">0</span>
      </button>
    </div>

    <!-- Filtros (móvil) -->
    <div class="md:hidden grid grid-cols-2 gap-2">
      <select id="m-f-categoria" class="rounded-lg border border-neutral-300 bg-white px-3 py-2 text-sm">
        <option value="">Categoría</option>
        <option>Seco</option><option>Húmedo</option><option>Snacks</option><option>Veterinary</option>
      </select>
      <select id="m-f-marca" class="rounded-lg border border-neutral-300 bg-white px-3 py-2 text-sm">
        <option value="">Marca</option>
        <option>Royal Canin</option><option>Purina</option><option>Cat Chow</option><option>Dog Chow</option><option>Excellent</option><option>Felix</option><option>Fancy Feast</option>
      </select>
      <select id="m-f-especie" class="rounded-lg border border-neutral-300 bg-white px-3 py-2 text-sm">
        <option value="">Especie</option><option>Gato</option><option>Perro</option>
      </select>
      <input id="m-f-search" type="search" placeholder="Buscar…" class="rounded-lg border border-neutral-300 bg-white px-3 py-2 text-sm"/>
      <button id="m-f-apply" class="col-span-2 rounded-lg border px-3 py-2 text-sm">Aplicar filtros</button>
    </div>
  </div>
</header>

<!-- Hero -->
<section class="max-w-6xl mx-auto px-4 pt-10 pb-6 grid md:grid-cols-2 gap-8 items-center">
  <div>
    <h1 class="text-4xl md:text-5xl font-extrabold leading-tight">
      Salud y bienestar <span class="text-rose-600">para tus mascotas</span>
    </h1>
    <p class="mt-4 text-slate-600 text-lg">
      Entrega rápida en Quito y Valles. Compra por WhatsApp. Productos oficiales Royal Canin y Purina.
    </p>
    <div class="mt-6 flex items-center gap-3">
      <a href="#promos" class="px-4 py-2 rounded-xl bg-rose-600 text-white hover:bg-rose-700">Promos</a>
      <a href="catalogo.html" class="px-4 py-2 rounded-xl bg-rose-600 text-white hover:bg-rose-700">Ver catálogo</a>
    </div>
  </div>
  <div class="rounded-2xl bg-white border grid place-items-center py-10">
    <div class="text-slate-400">Imagen referencial — Amicotti</div>
  </div>
</section>

<!-- Marcas -->
<section class="max-w-6xl mx-auto px-4">
  <h2 class="text-sm font-semibold text-slate-500 mb-3">Marcas que trabajamos</h2>
  <div class="flex items-center gap-4">
    <img src="assets/logo.png" class="h-10 w-auto" alt="Amicotti"/>
    <span class="chip px-2 py-1 rounded bg-slate-100 text-slate-600">Royal Canin</span>
    <span class="chip px-2 py-1 rounded bg-slate-100 text-slate-600">Purina</span>
  </div>
</section>

<!-- Promos (Carrusel) -->
<section id="promos" class="max-w-6xl mx-auto px-4 pt-10">
  <div class="flex items-baseline justify-between">
    <h2 class="text-xl font-semibold">Promos de la semana</h2>
    <a href="catalogo.html?marca=Royal+Canin" class="text-rose-600 hover:text-rose-700 text-sm">Ver todo →</a>
  </div>

  <div class="relative mt-4 overflow-hidden rounded-2xl border bg-white">
    <div id="promoTrack" class="carousel-track transition-transform duration-700 ease-in-out"><!-- Slides JS --></div>

    <button id="prevBtn" aria-label="Anterior"
            class="absolute left-2 top-1/2 -translate-y-1/2 bg-white/80 hover:bg-white text-slate-700 border rounded-full w-9 h-9 grid place-items-center shadow">‹</button>
    <button id="nextBtn" aria-label="Siguiente"
            class="absolute right-2 top-1/2 -translate-y-1/2 bg-white/80 hover:bg-white text-slate-700 border rounded-full w-9 h-9 grid place-items-center shadow">›</button>

    <div id="dots" class="absolute bottom-3 left-1/2 -translate-x-1/2 flex items-center gap-2"></div>
  </div>
</section>

<!-- FAQs -->
<section class="max-w-6xl mx-auto px-4 pt-12">
  <h2 class="text-xl font-semibold mb-4">Preguntas frecuentes</h2>
  <details class="border rounded-lg mb-3">
    <summary class="px-4 py-3 cursor-pointer font-medium">¿Zonas y tiempos de entrega?</summary>
    <div class="px-4 pb-4 text-slate-600">Quito y Valles. Entrega el mismo día en stock disponible.</div>
  </details>
  <details class="border rounded-lg mb-3">
    <summary class="px-4 py-3 cursor-pointer font-medium">¿Métodos de pago?</summary>
    <div class="px-4 pb-4 text-slate-600">Transferencia bancaria o efectivo contra entrega.</div>
  </details>
  <details class="border rounded-lg">
    <summary class="px-4 py-3 cursor-pointer font-medium">¿Emiten factura?</summary>
    <div class="px-4 pb-4 text-slate-600">Sí. Solicítala al cerrar tu pedido.</div>
  </details>
</section>

<!-- Contacto -->
<section id="contacto" class="max-w-6xl mx-auto px-4 pt-12 pb-16 grid md:grid-cols-3 gap-8">
  <div>
    <h3 class="font-semibold mb-2">Amicotti</h3>
    <p class="text-slate-600">Quito — Ecuador.</p>
  </div>
  <div>
    <h3 class="font-semibold mb-2">Contacto</h3>
    <p class="text-slate-600">WhatsApp: <a id="waFooter" class="text-rose-600 underline" target="_blank" rel="noopener"></a></p>
    <p class="text-slate-600">Email: amicotti.uio@gmail.com</p>
  </div>
  <div>
    <h3 class="font-semibold mb-2">Redes</h3>
    <p class="text-slate-600"><a href="#" class="underline">Instagram</a> · <a href="#" class="underline">Facebook</a></p>
  </div>
</section>

<footer class="border-t text-center text-xs text-slate-500 p-6">© <span id="yy"></span> Amicotti.</footer>

<!-- WA flotante -->
<a id="waFloat" class="fixed bottom-4 right-4 md:hidden w-12 h-12 rounded-full bg-rose-600 text-white grid place-items-center shadow-xl" target="_blank" rel="noopener">WA</a>

<!-- Overlay y Drawer del carrito -->
<div id="cart-overlay" class="fixed inset-0 z-40 hidden bg-black/40"></div>
<aside id="cart-drawer" class="fixed right-0 top-0 z-50 h-full w-full sm:w-[480px] translate-x-full bg-white shadow-2xl transition-transform duration-300">
  <div class="flex items-center justify-between border-b px-4 py-3">
    <h2 class="text-lg font-semibold">Tu pedido</h2>
    <button id="btn-cart-close" class="rounded-lg border px-2 py-1 text-sm">Cerrar</button>
  </div>
  <div id="cart-items" class="h-[calc(100vh-180px)] overflow-y-auto p-4 space-y-3"></div>
  <div class="border-t p-4 space-y-2">
    <div class="flex justify-between text-sm">
      <span>Subtotal</span><span id="cart-subtotal">$0.00</span>
    </div>
    <button id="btn-go-to-cart" class="w-full rounded-xl border px-4 py-2">Ver carrito</button>
    <button id="btn-checkout" class="w-full rounded-xl bg-rose-600 px-4 py-3 font-medium text-white">Finalizar pedido</button>
  </div>
</aside>

<script>
  // ===== Config =====
  const WA_PHONE = "593995315716";

  // ===== Util WA =====
  const waUrl = () => `https://wa.me/${WA_PHONE}`;
  const waForProduct = (name) => `https://wa.me/${WA_PHONE}?text=${encodeURIComponent(`Hola Amicotti, quiero ${name}`)}`;
  function setWALinks(){
    const top = document.getElementById('waTop');
    const flo = document.getElementById('waFloat');
    const foot = document.getElementById('waFooter');
    const head = document.getElementById('waHeader');
    if(top){ top.href = waUrl(); top.textContent = `Atención WhatsApp`; }
    if(flo){ flo.href = waUrl(); }
    if(foot){ foot.href = waUrl(); foot.textContent = `+${WA_PHONE}`; }
    if(head){ head.href = waUrl(); head.textContent = `WhatsApp`; }
  }

  // ===== Carrusel (igual que tu versión) =====
  function safeImg(img, fallback="assets/logo.png"){ img.onerror=null; img.src=fallback; }
  const PROMOS = [
    { brand:"Royal Canin", name:"Ageing 12+ Gato — 2 kg", species:"Gato • Seco", price:"", href:"catalogo.html?marca=Royal+Canin&buscar=ageing", image:{ webp:"assets/royal/royal-ageing-12-gato.webp" } },
    { brand:"Royal Canin", name:"Bulldog Puppy — 3 kg", species:"Perro • Seco", price:"", href:"catalogo.html?marca=Royal+Canin&buscar=bulldog+puppy", image:{ jpg:"assets/royal/royal-bulldog-puppy-perro.jpg" } },
    { brand:"Royal Canin", name:"Calm Feline — 2 kg", species:"Gato • Seco", price:"", href:"catalogo.html?marca=Royal+Canin&buscar=calm+feline", image:{ png:"assets/royal/royal-calm-feline-gato.png" } },
    { brand:"Royal Canin", name:"Cardiac Canine — 2 kg", species:"Perro • Veterinario", price:"", href:"catalogo.html?marca=Royal+Canin&buscar=cardiac+canine", image:{ png:"assets/royal/royal-cardiac-canine-perro.png" } }
  ];
  let current = 0, autoplayId = null; const AUTOPLAY_MS = 3500;
  function buildSlide(p){
    let pictureHTML=''; if(p.image.webp) pictureHTML+=`<source srcset="${p.image.webp}" type="image/webp">`;
    const fallbackSrc = p.image.jpg || p.image.png || p.image.webp || "assets/logo.png";
    pictureHTML+=`<img src="${fallbackSrc}" alt="${p.name}" class="promo-img" onerror="safeImg(this)">`;
    return `<div class="carousel-slide"><div class="grid md:grid-cols-2 items-center">
      <div class="promo-img-wrap"><picture>${pictureHTML}</picture></div>
      <div class="p-6 md:p-10">
        <span class="chip px-2 py-1 rounded bg-slate-100 text-slate-600">${p.species}</span>
        <h3 class="mt-3 text-2xl font-semibold leading-tight">${p.name}</h3>
        <p class="text-slate-500">${p.brand}</p>
        <div class="mt-5 flex flex-wrap gap-3">
          <a href="${p.href}" class="px-4 py-2 rounded-xl bg-rose-600 text-white hover:bg-rose-700">Ver en catálogo</a>
          <a href="${waForProduct(p.name)}" target="_blank" rel="noopener" class="px-4 py-2 rounded-xl border hover:bg-slate-50">WhatsApp</a>
        </div>
      </div></div></div>`;
  }
  function renderCarousel(){
    const track=document.getElementById('promoTrack'); if(!track) return;
    track.innerHTML = PROMOS.map(buildSlide).join('');
    const dots=document.getElementById('dots');
    dots.innerHTML = PROMOS.map((_,i)=>`<button class="dot ${i===0?'bg-rose-600':'bg-slate-300'}" data-dot="${i}" aria-label="Ir a slide ${i+1}"></button>`).join('');
    dots.querySelectorAll('[data-dot]').forEach(btn=>btn.addEventListener('click',()=>goTo(+btn.dataset.dot,true)));
    const container = track.parentElement;
    container.addEventListener('mouseenter', pauseAutoplay);
    container.addEventListener('mouseleave', startAutoplay);
    document.getElementById('prevBtn').addEventListener('click',()=>prev(true));
    document.getElementById('nextBtn').addEventListener('click',()=>next(true));
    startAutoplay(); updateUI();
  }
  function updateUI(){ document.getElementById('promoTrack').style.transform=`translateX(-${current*100}%)`;
    const dots=document.getElementById('dots').children; [...dots].forEach((d,i)=>d.className=`dot ${i===current?'bg-rose-600':'bg-slate-300'}`); }
  function goTo(i,manual=false){ current=(i+PROMOS.length)%PROMOS.length; updateUI(); if(manual) restartAutoplay(); }
  function next(m=false){ goTo(current+1,m);} function prev(m=false){ goTo(current-1,m);}
  function startAutoplay(){ if(autoplayId) return; autoplayId=setInterval(next, AUTOPLAY_MS); }
  function pauseAutoplay(){ if(autoplayId){ clearInterval(autoplayId); autoplayId=null; } }
  function restartAutoplay(){ pauseAutoplay(); startAutoplay(); }

  // ===== Carrito (localStorage) =====
  const CART_KEY='amicotti_cart';
  const getCart = () => JSON.parse(localStorage.getItem(CART_KEY) || '[]');
  const setCart = (items) => localStorage.setItem(CART_KEY, JSON.stringify(items));
  const cartTotal = (items) => items.reduce((s,i)=> s + (i.price*i.qty), 0);

  const drawer = document.getElementById('cart-drawer');
  const overlay = document.getElementById('cart-overlay');
  const cartCount = document.getElementById('cart-count');
  const cartItemsEl = document.getElementById('cart-items');
  const cartSubtotalEl = document.getElementById('cart-subtotal');

  function openDrawer(){ drawer.classList.remove('translate-x-full'); overlay.classList.remove('hidden'); document.body.classList.add('overflow-hidden'); }
  function closeDrawer(){ drawer.classList.add('translate-x-full'); overlay.classList.add('hidden'); document.body.classList.remove('overflow-hidden'); }

  document.getElementById('btn-cart-open').addEventListener('click', ()=>{ renderDrawer(); openDrawer(); });
  document.getElementById('btn-cart-close').addEventListener('click', closeDrawer);
  overlay.addEventListener('click', closeDrawer);

  function renderDrawer(){
    const items = getCart();
    cartCount.textContent = items.reduce((s,i)=>s+i.qty,0);
    cartItemsEl.innerHTML = items.length ? '' : '<p class="text-sm text-neutral-500">Tu carrito está vacío.</p>';
    items.forEach((it, idx)=>{
      const row = document.createElement('div');
      row.className = 'flex gap-3 items-center';
      row.innerHTML = `
        <img src="${it.img || 'assets/logo.png'}" class="h-16 w-16 rounded object-contain border"/>
        <div class="flex-1">
          <div class="text-sm font-medium">${it.title}</div>
          <div class="text-xs text-neutral-500">${it.variant||''}</div>
          <div class="mt-1 flex items-center gap-2">
            <button data-idx="${idx}" data-act="dec" class="rounded border px-2 text-xs">-</button>
            <span class="text-sm">${it.qty}</span>
            <button data-idx="${idx}" data-act="inc" class="rounded border px-2 text-xs">+</button>
            <button data-idx="${idx}" data-act="del" class="ml-2 text-xs text-rose-600 underline">Eliminar</button>
          </div>
        </div>
        <div class="text-sm font-medium">$${(it.price*it.qty).toFixed(2)}</div>`;
      cartItemsEl.appendChild(row);
    });
    cartSubtotalEl.textContent = `$${cartTotal(items).toFixed(2)}`;
  }

  cartItemsEl?.addEventListener('click', (e)=>{
    const btn = e.target.closest('button'); if(!btn) return;
    const idx = +btn.dataset.idx; const act = btn.dataset.act; const items = getCart(); if(Number.isNaN(idx)||!items[idx]) return;
    if(act==='inc') items[idx].qty++;
    if(act==='dec') items[idx].qty = Math.max(1, items[idx].qty-1);
    if(act==='del') items.splice(idx,1);
    setCart(items); renderDrawer();
  });

  document.getElementById('btn-go-to-cart').addEventListener('click', ()=>{ window.location.href = 'cart.html'; });
  document.getElementById('btn-checkout').addEventListener('click', ()=>{ window.location.href = 'checkout.html'; });

  // Exponer addToCart para tarjetas (si lo usas desde el home)
  window.addToCart = function(product){
    const items = getCart();
    const i = items.findIndex(x=> x.id===product.id && x.variant===product.variant);
    if(i>-1) items[i].qty += product.qty || 1; else items.push({...product, qty: product.qty||1});
    setCart(items); renderDrawer(); openDrawer();
  }
  // contador al cargar
  (function(){ cartCount.textContent = getCart().reduce((s,i)=>s+i.qty,0); })();

  // ===== Filtros → redirigir a catalogo.html con query =====
  function readFilters(){
    const categoria = document.getElementById('f-categoria')?.value || document.getElementById('m-f-categoria')?.value || '';
    const marca = document.getElementById('f-marca')?.value || document.getElementById('m-f-marca')?.value || '';
    const especie = document.getElementById('f-especie')?.value || document.getElementById('m-f-especie')?.value || '';
    const buscar = document.getElementById('f-search')?.value || document.getElementById('m-f-search')?.value || '';
    const params = new URLSearchParams();
    if(categoria) params.set('categoria', categoria);
    if(marca) params.set('marca', marca);
    if(especie) params.set('especie', especie);
    if(buscar) params.set('buscar', buscar);
    return `catalogo.html${params.toString()?`?${params.toString()}`:''}`;
  }
  document.getElementById('f-search-btn')?.addEventListener('click', ()=>{ window.location.href = readFilters(); });
  document.getElementById('m-f-apply')?.addEventListener('click', ()=>{ window.location.href = readFilters(); });
  ['f-categoria','f-marca','f-especie'].forEach(id=>{
    document.getElementById(id)?.addEventListener('change', ()=>{ window.location.href = readFilters(); });
  });

  // ===== Init =====
  (function(){
    setWALinks();
    document.getElementById('yy').textContent = new Date().getFullYear();
    renderCarousel();
  })();
</script>
</body>
</html>
